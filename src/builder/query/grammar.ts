import { Grammar } from 'prismjs';

export const DRUID_SQL_KEYWORDS_FUNCS = [
  // Keywords
  'ALL',
  'AS',
  'ASC',
  'BY',
  'CUBE',
  'DESC',
  'DISTINCT',
  'EXPLAIN',
  'FOR',
  'FROM',
  'GROUP',
  'GROUPING',
  'HAVING',
  'INNER',
  'JOIN',
  'LEFT',
  'LIMIT',
  'OFFSET',
  'ON',
  'ORDER',
  'ROLLUP',
  'SELECT',
  'SETS',
  'UNION',
  'WHERE',
  'WITH',

  // Functions, aggregation
  'COUNT',
  'SUM',
  'MIN',
  'MAX',
  'AVG',
  'APPROX_COUNT_DISTINCT',
  'APPROX_COUNT_DISTINCT_DS_HLL',
  'APPROX_COUNT_DISTINCT_DS_THETA',
  'DS_HLL',
  'DS_THETA',
  'APPROX_QUANTILE',
  'APPROX_QUANTILE_DS',
  'APPROX_QUANTILE_FIXED_BUCKETS',
  'DS_QUANTILES_SKETCH',
  'BLOOM_FILTER',
  'TDIGEST_QUANTILE',
  'TDIGEST_GENERATE_SKETCH',
  'VAR_POP',
  'VAR_SAMP',
  'VARIANCE',
  'STDDEV_POP',
  'STDDEV_SAMP',
  'STDDEV',
  'EARLIEST',
  'LATEST',
  'ANY_VALUE',

  // Functions, scalar - numeric
  'ABS',
  'CEIL',
  'EXP',
  'FLOOR',
  'LN',
  'LOG10',
  'POWER',
  'SQRT',
  'TRUNCATE',
  'TRUNC',
  'ROUND',
  'MOD',
  'SIN',
  'COS',
  'TAN',
  'COT',
  'ASIN',
  'ACOS',
  'ATAN',
  'ATAN2',
  'DEGREES',
  'RADIANS',

  // Functions, scalar - string
  'CONCAT',
  'TEXTCAT',
  'STRING_FORMAT',
  'LENGTH',
  'CHAR_LENGTH',
  'CHARACTER_LENGTH',
  'STRLEN',
  'LOOKUP',
  'LOWER',
  'PARSE_LONG',
  'POSITION',
  'REGEXP_EXTRACT',
  'REGEXP_LIKE',
  'CONTAINS_STRING',
  'ICONTAINS_STRING',
  'REPLACE',
  'STRPOS',
  'SUBSTRING',
  'RIGHT',
  'LEFT',
  'SUBSTR',
  'TRIM',
  'BTRIM',
  'LTRIM',
  'RTRIM',
  'UPPER',
  'REVERSE',
  'REPEAT',
  'LPAD',
  'RPAD',

  // Functions, scalar - time
  'CURRENT_TIMESTAMP',
  'CURRENT_DATE',
  'DATE_TRUNC',
  'TIME_CEIL',
  'TIME_FLOOR',
  'TIME_SHIFT',
  'TIME_EXTRACT',
  'TIME_PARSE',
  'TIME_FORMAT',
  'MILLIS_TO_TIMESTAMP',
  'TIMESTAMP_TO_MILLIS',
  'EXTRACT',
  'FLOOR',
  'CEIL',
  'TIMESTAMPADD',
  'TIMESTAMPDIFF',

  // Functions, scalar - reduction
  'GREATEST',
  'LEAST',

  // Functions, scalar - IP address
  'IPV4_MATCH',
  'IPV4_PARSE',
  'IPV4_STRINGIFY',

  // Functions, scalar - sketch: HLL (HyperLogLog)
  'HLL_SKETCH_ESTIMATE',
  'HLL_SKETCH_ESTIMATE_WITH_ERROR_BOUNDS',
  'HLL_SKETCH_UNION',
  'HLL_SKETCH_TO_STRING',

  // Functions, scalar - sketch: theta
  'THETA_SKETCH_ESTIMATE',
  'THETA_SKETCH_ESTIMATE_WITH_ERROR_BOUNDS',
  'THETA_SKETCH_UNION',
  'THETA_SKETCH_INTERSECT',
  'THETA_SKETCH_NOT',

  // Functions, scalar - sketch: quantiles
  'DS_GET_QUANTILE',
  'DS_GET_QUANTILES',
  'DS_HISTOGRAM',
  'DS_CDF',
  'DS_RANK',
  'DS_QUANTILE_SUMMARY',

  // Functions, scalar - other
  'CAST',
  'CASE',
  'NULLIF',
  'COALESCE',
  'NVL',
  'BLOOM_FILTER_TEST',

  // Functions, multi-value
  'ARRAY',
  'MV_LENGTH',
  'MV_OFFSET',
  'MV_ORDINAL',
  'MV_CONTAINS',
  'MV_OVERLAP',
  'MV_OFFSET_OF',
  'MV_ORDINAL_OF',
  'MV_PREPEND',
  'MV_APPEND',
  'MV_CONCAT',
  'MV_SLICE',
  'MV_TO_STRING',
  'STRING_TO_MV',
];

export const DruidSQLPrismGrammar: Grammar = {
  function: /(COUNT|SUM|MIN|MAX|AVG|APPROX_COUNT_DISTINCT|APPROX_COUNT_DISTINCT_DS_HLL|APPROX_COUNT_DISTINCT_DS_THETA|DS_HLL|DS_THETA|APPROX_QUANTILE|APPROX_QUANTILE_DS|APPROX_QUANTILE_FIXED_BUCKETS|DS_QUANTILES_SKETCH|BLOOM_FILTER|TDIGEST_QUANTILE|TDIGEST_GENERATE_SKETCH|VAR_POP|VAR_SAMP|VARIANCE|STDDEV_POP|STDDEV_SAMP|STDDEV|EARLIEST|LATEST|ANY_VALUE|ABS|CEIL|EXP|FLOOR|LN|LOG10|POWER|SQRT|TRUNCATE|TRUNC|ROUND|MOD|SIN|COS|TAN|COT|ASIN|ACOS|ATAN|ATAN2|DEGREES|RADIANS|CONCAT|TEXTCAT|STRING_FORMAT|LENGTH|CHAR_LENGTH|CHARACTER_LENGTH|STRLEN|LOOKUP|LOWER|PARSE_LONG|POSITION|REGEXP_EXTRACT|REGEXP_LIKE|CONTAINS_STRING|ICONTAINS_STRING|REPLACE|STRPOS|SUBSTRING|RIGHT|LEFT|SUBSTR|TRIM|BTRIM|LTRIM|RTRIM|UPPER|REVERSE|REPEAT|LPAD|RPAD|CURRENT_TIMESTAMP|CURRENT_DATE|DATE_TRUNC|TIME_CEIL|TIME_FLOOR|TIME_SHIFT|TIME_EXTRACT|TIME_PARSE|TIME_FORMAT|MILLIS_TO_TIMESTAMP|TIMESTAMP_TO_MILLIS|EXTRACT|FLOOR|CEIL|TIMESTAMPADD|TIMESTAMPDIFF|GREATEST|LEAST|IPV4_MATCH|IPV4_PARSE|IPV4_STRINGIFY|HLL_SKETCH_ESTIMATE|HLL_SKETCH_ESTIMATE_WITH_ERROR_BOUNDS|HLL_SKETCH_UNION|HLL_SKETCH_TO_STRING|THETA_SKETCH_ESTIMATE|THETA_SKETCH_ESTIMATE_WITH_ERROR_BOUNDS|THETA_SKETCH_UNION|THETA_SKETCH_INTERSECT|THETA_SKETCH_NOT|DS_GET_QUANTILE|DS_GET_QUANTILES|DS_HISTOGRAM|DS_CDF|DS_RANK|DS_QUANTILE_SUMMARY|CAST|CASE|NULLIF|COALESCE|NVL|BLOOM_FILTER_TEST|ARRAY|MV_LENGTH|MV_OFFSET|MV_ORDINAL|MV_CONTAINS|MV_OVERLAP|MV_OFFSET_OF|MV_ORDINAL_OF|MV_PREPEND|MV_APPEND|MV_CONCAT|MV_SLICE|MV_TO_STRING|STRING_TO_MV)/,
  keyword: /(ALL|AS|ASC|BY|CUBE|DESC|DISTINCT|EXPLAIN|FOR|FROM|GROUP|GROUPING|HAVING|INNER|JOIN|LEFT|LIMIT|OFFSET|ON|ORDER|ROLLUP|SELECT|SETS|UNION|WHERE|WITH)/,
  number: /\s*([^A-Za-z][0-9]+[^A-Za-z])\s*/,
  punctuation: /,/,
  string: /\"([^ ]+)\"/,
};
